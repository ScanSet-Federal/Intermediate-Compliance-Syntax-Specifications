DEF
VAR var_161 string ``
VAR var_2 string `2016|2017|2019|2022`
VAR var_1 string `sqlserver`
CRI OR
CTN sqlext
    TEST `none exist` all
    OBJECT obj_161
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database `.*`
        sql `;with objects_cte as
(SELECT o.name, o.type_desc,
   CASE
    WHEN o.principal_id is null then s.principal_id
     ELSE o.principal_id
    END as principal_id
 FROM sys.objects o
 INNER JOIN sys.schemas s
 ON o.schema_id = s.schema_id
 WHERE o.is_ms_shipped = 0
)
SELECT cte.name, cte.type_desc, dp.name as object_owner 
FROM objects_cte cte
INNER JOIN sys.database_principals dp
ON cte.principal_id = dp.principal_id
ORDER BY dp.name, cte.name`
        behavior context database
    OBJECT_END
CTN_END
CTN sqlext
    TEST `any exist` all
    STATE ste_162
        result string equals `
    `
    STATE_END
    OBJECT obj_161
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database `.*`
        sql `;with objects_cte as
(SELECT o.name, o.type_desc,
   CASE
    WHEN o.principal_id is null then s.principal_id
     ELSE o.principal_id
    END as principal_id
 FROM sys.objects o
 INNER JOIN sys.schemas s
 ON o.schema_id = s.schema_id
 WHERE o.is_ms_shipped = 0
)
SELECT cte.name, cte.type_desc, dp.name as object_owner 
FROM objects_cte cte
INNER JOIN sys.database_principals dp
ON cte.principal_id = dp.principal_id
ORDER BY dp.name, cte.name`
        behavior context database
    OBJECT_END
CTN_END
CRI_END
DEF_END