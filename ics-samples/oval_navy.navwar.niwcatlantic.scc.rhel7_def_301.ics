DEF
STATE ste_301
    subexpression string equals `\sdeny\s*=\s*[123]{1}[^\S]`
STATE_END
STATE ste_303
    subexpression string equals `\sfail_interval\s*=\s*((9\d\d)|([1-9]\d\d\d+))\s*`
STATE_END
STATE ste_304
    subexpression string equals `\sunlock_time\s*=\s*((9\d\d)|([1-9]\d\d\d+))\s*`
STATE_END
STATE ste_302
    subexpression string equals `\seven_deny_root\s*`
STATE_END
CRI AND
CTN textfilecontent54
    TEST `at least one exists` all
    STATE_REF ste_301
    STATE_REF ste_302
    STATE_REF ste_303
    STATE_REF ste_304
    OBJECT obj_301
        filepath `/etc/pam.d/password-auth`
        pattern `^\n*[^\S#]*auth\s+required\s+pam_faillock.so\s+(.*)\n*`
        instance `1`
        behavior singleline false
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` all
    STATE_REF ste_301
    STATE_REF ste_302
    STATE_REF ste_303
    STATE_REF ste_304
    OBJECT obj_302
        filepath `/etc/pam.d/password-auth`
        pattern `^\n*[^\S#]*auth\s+\[default=die\]\s+pam_faillock.so\s+(.*)\n*`
        instance `1`
        behavior singleline false
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` all
    STATE_REF ste_301
    STATE_REF ste_302
    STATE_REF ste_303
    STATE_REF ste_304
    OBJECT obj_303
        filepath `/etc/pam.d/system-auth`
        pattern `^\n*[^\S#]*auth\s+required\s+pam_faillock.so\s+(.*)\n*`
        instance `1`
        behavior singleline false
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` all
    STATE_REF ste_301
    STATE_REF ste_302
    STATE_REF ste_303
    STATE_REF ste_304
    OBJECT obj_304
        filepath `/etc/pam.d/system-auth`
        pattern `^\n*[^\S#]*auth\s+\[default=die\]\s+pam_faillock.so\s+(.*)\n*`
        instance `1`
        behavior singleline false
    OBJECT_END
CTN_END
CRI_END
DEF_END