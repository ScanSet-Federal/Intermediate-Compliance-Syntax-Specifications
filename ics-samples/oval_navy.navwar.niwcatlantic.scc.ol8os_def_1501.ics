DEF
STATE ste_1501
    subexpression string equals `^\s*retry\s*=\s*[123]$`
STATE_END
CRI AND
CRI AND
CRI OR
CTN textfilecontent54
    TEST `at least one exists` all
    STATE_REF ste_1501
    OBJECT obj_1501
        filepath `/etc/security/pwquality.conf`
        pattern `^(\s*retry\s*=\s*\d+)\s*$`
        instance `1`
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` all
    STATE_REF ste_1501
    OBJECT obj_1502
        path `/etc/security/pwquality.conf.d`
        filename `.+`
        pattern `^(\s*retry\s*=\s*\d+)\s*$`
        instance `1`
    OBJECT_END
CTN_END
CRI_END
CRI AND
CTN textfilecontent54
    TEST `none exist` all
    OBJECT obj_1503
        filepath `/etc/pam.d/system-auth`
        pattern `^[ \t]*password\s+(.*\sretry.*)$`
        instance `1`
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `none exist` all
    OBJECT obj_1504
        filepath `/etc/pam.d/password-auth`
        pattern `^[ \t]*password\s+(.*\sretry.*)$`
        instance `1`
        behavior multiline true
    OBJECT_END
CTN_END
CRI_END
CRI_END
CRI_END
DEF_END