DEF
VAR var_1 string `sqlserver`
VAR var_2 string `2016|2017|2019|2022`
CRI OR
CTN sqlext
    TEST `any exist` all
    STATE ste_1981
        result string equals `
    `
    STATE_END
    OBJECT obj_1981
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `DECLARE @HiddenInstance INT 
EXEC master.dbo.Xp_instance_regread 
 N'HKEY_LOCAL_MACHINE', 
 N'Software\Microsoft\MSSQLServer\MSSQLServer\SuperSocketNetLib', 
 N'HideInstance', 
 @HiddenInstance output 
SELECT CASE 
        WHEN @HiddenInstance = 0 
             AND Serverproperty('IsClustered') = 0 THEN 'No' 
        ELSE 'Yes' 
      END AS [hidden]`
        behavior context instance
    OBJECT_END
CTN_END
CTN service
    TEST `any exist` all
    STATE ste_1941
        start_type string equals `SERVICE_DISABLED`
        current_state string equals `SERVICE_STOPPED`
    STATE_END
    OBJECT obj_1941
        service_name `SQLBrowser`
    OBJECT_END
CTN_END
CRI_END
DEF_END