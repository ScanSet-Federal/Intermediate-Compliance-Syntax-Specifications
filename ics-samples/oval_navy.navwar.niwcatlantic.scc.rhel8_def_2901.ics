DEF
VAR var_2901 string ``
RUN var_2901 EXTRACT
    OBJ obj_2902 stdout_line
RUN_END
STATE ste_2902
    filename string equals `^\.`
STATE_END
STATE ste_2903
    filename string equals `.bash_history`
STATE_END
CRI AND
CTN textfilecontent54
    TEST `any exist` all
    STATE ste_2901
        text string equals `^\s*umask\s+0[0-7]77`
    STATE_END
    OBJECT obj_2901
        path VAR var_2901
        filename `^\.`
        pattern `^\s*umask.*\s+(\d+)`
        instance `1`
        FILTER include
            STATE_REF ste_2902
        FILTER_END
        FILTER include
            STATE_REF ste_2903
        FILTER_END
    OBJECT_END
CTN_END
CTN shellcommand
    TEST `any exist` all
    OBJECT obj_2902
        shell `bash`
        command `ls -d $(awk -F: '($3>=1000)&&($7 !~ /nologin/){print $6}' /etc/passwd)`
    OBJECT_END
CTN_END
CRI_END
DEF_END