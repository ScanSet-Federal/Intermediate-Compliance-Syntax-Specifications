DEF
VAR var_104 string `CONNECT SQL`
VAR var_102 string `CONNECT SQL`
VAR var_2 string `2016|2017|2019|2022`
VAR var_106 string `CONNECT SQL`
VAR var_1 string `sqlserver`
CRI AND
CRI OR
CRI AND
CTN sqlext
    TEST `any exist` all
    STATE ste_101
        result string equals `
    `
    STATE_END
    OBJECT obj_101
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `SELECT
    SERVERPROPERTY('IsClustered') AS [is_clustered],
    SERVERPROPERTY('IsHadrEnabled') AS [is_hadr_enabled]`
        behavior context instance
    OBJECT_END
CTN_END
CTN sqlext
    TEST `any exist` all
    STATE ste_102
        result string equals `
    `
    STATE_END
    OBJECT obj_102
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `EXECUTE AS LOGIN = 'NT AUTHORITY\SYSTEM';
SELECT * FROM fn_my_permissions(NULL, 'server');
REVERT;
`
        behavior context instance
    OBJECT_END
CTN_END
CRI_END
CTN sqlext
    TEST `any exist` all
    STATE ste_101
        result string equals `
    `
    STATE_END
    OBJECT obj_101
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `SELECT
    SERVERPROPERTY('IsClustered') AS [is_clustered],
    SERVERPROPERTY('IsHadrEnabled') AS [is_hadr_enabled]`
        behavior context instance
    OBJECT_END
CTN_END
CRI_END
CRI OR
CRI AND
CTN sqlext
    TEST `any exist` all
    STATE ste_103
        result string equals `
    `
    STATE_END
    OBJECT obj_101
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `SELECT
    SERVERPROPERTY('IsClustered') AS [is_clustered],
    SERVERPROPERTY('IsHadrEnabled') AS [is_hadr_enabled]`
        behavior context instance
    OBJECT_END
CTN_END
CTN sqlext
    TEST `any exist` all
    STATE ste_104
        result string equals `
    `
    STATE_END
    OBJECT obj_102
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `EXECUTE AS LOGIN = 'NT AUTHORITY\SYSTEM';
SELECT * FROM fn_my_permissions(NULL, 'server');
REVERT;
`
        behavior context instance
    OBJECT_END
CTN_END
CRI_END
CTN sqlext
    TEST `any exist` all
    STATE ste_103
        result string equals `
    `
    STATE_END
    OBJECT obj_101
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `SELECT
    SERVERPROPERTY('IsClustered') AS [is_clustered],
    SERVERPROPERTY('IsHadrEnabled') AS [is_hadr_enabled]`
        behavior context instance
    OBJECT_END
CTN_END
CRI_END
CRI OR
CRI AND
CTN sqlext
    TEST `any exist` all
    STATE ste_105
        result string equals `
    `
    STATE_END
    OBJECT obj_101
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `SELECT
    SERVERPROPERTY('IsClustered') AS [is_clustered],
    SERVERPROPERTY('IsHadrEnabled') AS [is_hadr_enabled]`
        behavior context instance
    OBJECT_END
CTN_END
CTN sqlext
    TEST `any exist` all
    STATE ste_106
        result string equals `
    `
    STATE_END
    OBJECT obj_102
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `EXECUTE AS LOGIN = 'NT AUTHORITY\SYSTEM';
SELECT * FROM fn_my_permissions(NULL, 'server');
REVERT;
`
        behavior context instance
    OBJECT_END
CTN_END
CRI_END
CTN sqlext
    TEST `any exist` all
    STATE ste_105
        result string equals `
    `
    STATE_END
    OBJECT obj_101
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `SELECT
    SERVERPROPERTY('IsClustered') AS [is_clustered],
    SERVERPROPERTY('IsHadrEnabled') AS [is_hadr_enabled]`
        behavior context instance
    OBJECT_END
CTN_END
CRI_END
CRI_END
DEF_END