DEF
VAR var_201 string ``
VAR var_1 string `sqlserver`
VAR var_2 string `2016|2017|2019|2022`
CRI AND
CTN sqlext
    TEST `any exist` all
    STATE ste_201
        result string equals `
    `
    STATE_END
    OBJECT obj_201
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database `.*`
        sql `SELECT name, recovery_model_desc
FROM sys.databases
WHERE name = DB_NAME()
ORDER BY name`
        behavior context database
    OBJECT_END
CTN_END
CTN sqlext
    TEST `any exist` all
    OBJECT obj_202
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database `.*`
        sql `SELECT database_name,
   CASE type
    WHEN 'D' THEN 'Full'
    WHEN 'I' THEN 'Differential'
    WHEN 'L' THEN 'Log'
   ELSE type
   END AS backup_type,
 is_copy_only,
 backup_start_date, backup_finish_date
FROM msdb.dbo.backupset
WHERE backup_start_date >= dateadd(day, - 30, getdate()) 
AND database_name = DB_NAME()
ORDER BY database_name, backup_start_date DESC
`
        behavior context database
    OBJECT_END
CTN_END
CRI_END
DEF_END