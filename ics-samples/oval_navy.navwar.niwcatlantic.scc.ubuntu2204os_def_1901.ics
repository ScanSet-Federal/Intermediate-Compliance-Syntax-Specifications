DEF
VAR var_1901 string ``
VAR var_1902 string ``
RUN var_1901 EXTRACT
    OBJ obj_1903 inet_addr
RUN_END
RUN var_1902 EXTRACT
    OBJ obj_1913 inet_addr
RUN_END
CRI AND
CTN shellcommand
    TEST `at least one exists` all
    STATE ste_1901
        subexpression string equals `audispd\-plugins`
    STATE_END
    OBJECT obj_1901
        shell `bash`
        command `dpkg -l | grep audispd-plugins`
        pattern `\s*ii\s+(audispd-plugins)\s+`
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` all
    OBJECT obj_1902
        filepath `/etc/audit/plugins.d/au-remote.conf`
        pattern `^\s*active\s*=\s*yes\s*`
        instance `1`
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` `at least one`
    STATE ste_1905
        instance int `greater than or equal` `1`
        subexpression string equals `^((((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])))|((?:(?!0{1,4}:)(?:(?:[0-9a-fA-F]){1,4}):)(?:(?:(?:(?:[0-9a-fA-F]){1,4}):)|:){4}(?:[0-9a-fA-F]){1,4}))$`
    STATE_END
    OBJECT obj_1904
        path `/etc/audit`
        filename `audisp-remote.conf`
        pattern `\s*remote_server\s*=\s*(\S+)(?:\s|$)`
        instance `1`
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` `at least one` OR
    STATE ste_1906
        instance int `greater than or equal` `1`
        subexpression string equals `VAR var_1901`
    STATE_END
    STATE ste_1907
        instance int `greater than or equal` `1`
        subexpression string equals `VAR var_1902`
    STATE_END
    OBJECT obj_1904
        path `/etc/audit`
        filename `audisp-remote.conf`
        pattern `\s*remote_server\s*=\s*(\S+)(?:\s|$)`
        instance `1`
    OBJECT_END
CTN_END
CTN interface
    TEST `any exist` all
    OBJECT obj_1903
        name `.*`
        FILTER include
            STATE_REF ste_1903
        FILTER_END
    OBJECT_END
CTN_END
CTN interface
    TEST `any exist` all
    OBJECT obj_1913
        name `.*`
        FILTER include
            STATE_REF ste_1904
        FILTER_END
    OBJECT_END
CTN_END
CRI_END
DEF_END