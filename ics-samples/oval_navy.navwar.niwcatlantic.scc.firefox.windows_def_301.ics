DEF
VAR var_304 string `HTA`
VAR var_302 string ``
VAR var_303 string ``
VAR var_301 string ``
RUN var_302 CONCAT
    literal `(?i)`
    literal `":\{"action":(\d),"extensions":\["`
    VAR var_304
    literal `"\]`
RUN_END
RUN var_303 CONCAT
    OBJ obj_303 value
    literal `\AppData\Roaming\Mozilla\Firefox\Profiles`
RUN_END
RUN var_301 EXTRACT
    OBJ obj_302 filepath
RUN_END
CRI AND
CTN textfilecontent54
    TEST `any exist` all
    STATE ste_301
        subexpression string equals `0|1`
    STATE_END
    OBJECT obj_301
        filepath VAR var_301
        pattern VAR var_302
        instance `1`
    OBJECT_END
CTN_END
CTN registry
    TEST `any exist` all
    OBJECT obj_303
        hive `HKEY_LOCAL_MACHINE`
        key `SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList`
        name `ProfileImagePath`
        behavior max_depth 2 recurse_direction down
        FILTER include
            STATE_REF ste_303
        FILTER_END
    OBJECT_END
CTN_END
CTN file
    TEST `any exist` all
    OBJECT obj_302
        path VAR var_303
        filename `handlers.json`
        behavior max_depth 2 recurse_direction down
    OBJECT_END
CTN_END
CRI_END
DEF_END