DEF
SET obj_23048100 union
    OBJECT obj_23048101
        filepath `/etc/rsyslog.conf`
        pattern `^\$ActionSendStreamDriverMode\s+(\S+)\s*$`
        instance `1`
    OBJECT_END
    OBJECT obj_23048102
        path `/etc/rsyslog.d`
        filename `^.*\.conf$`
        pattern `^\$ActionSendStreamDriverMode\s+(\S+)\s*$`
        instance `1`
    OBJECT_END
SET_END
SET obj_20000005 union
    OBJECT obj_20000006
        filepath `/etc/rsyslog.conf`
        pattern `^\s*module\((\s*(?:[^#\)]*(?:#.*$)?\n)*[^#\)]*)\)`
        instance `1`
    OBJECT_END
    OBJECT obj_20000007
        path `/etc/rsyslog.d`
        filename `^.*\.conf$`
        pattern `^\s*module\((\s*(?:[^#\)]*(?:#.*$)?\n)*[^#\)]*)\)`
        instance `1`
    OBJECT_END
SET_END
SET obj_20000002 union
    OBJECT obj_20000003
        filepath `/etc/rsyslog.conf`
        pattern `^\*\.\*\s+action\((\s*(?:[^#\)]*(?:#.*$)?\n)*[^#\)]*)\)`
        instance `1`
    OBJECT_END
    OBJECT obj_20000004
        path `/etc/rsyslog.d`
        filename `^.*\.conf$`
        pattern `^\*\.\*\s+action\((\s*(?:[^#\)]*(?:#.*$)?\n)*[^#\)]*)\)`
        instance `1`
    OBJECT_END
SET_END
CRI AND
CRI OR
CTN textfilecontent54
    TEST `at least one exists` all
    STATE ste_20000003
        subexpression int equals `1`
    STATE_END
    OBJECT obj_23048100
        SET_REF obj_23048100
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` `at least one`
    STATE ste_20000027
        subexpression string equals `(?i)(?:^|\n)[^#]*\btype\s*=\s*"omfwd"`
    STATE_END
    STATE ste_23048100
        subexpression string equals `(?i)(?:^|\n)[^#]*\bStreamDriver\.?Mode\s*=\s*"1"`
    STATE_END
    OBJECT obj_20000002
        SET_REF obj_20000002
    OBJECT_END
CTN_END
CRI_END
CTN textfilecontent54
    TEST `any exist` `none satisfy`
    STATE ste_23048101
        subexpression string equals `(?i)(?:^|\n)[^#]*\bStreamDriver\.?Mode\b`
    STATE_END
    OBJECT obj_20000005
        SET_REF obj_20000005
    OBJECT_END
CTN_END
CRI_END
DEF_END