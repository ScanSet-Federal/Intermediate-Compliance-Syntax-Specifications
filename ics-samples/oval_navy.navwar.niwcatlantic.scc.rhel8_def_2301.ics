DEF
CRI AND
CTN shellcommand
    TEST `any exist` all
    STATE ste_2301
        stdout_line string equals `.*`
    STATE_END
    OBJECT obj_2301
        shell `bash`
        command `getent passwd | awk -F: '$3>=1000 && $7 !="/bin/nologin" && $1 != "nobody" { print $1 ":" $6 ":" $4 }' | while IFS=':' read -r user homedir usergroup; do filegroup=$(stat -c '%g' "$homedir"); [ "$usergroup" != "$filegroup" ] && echo "User home directory for $user is not group owned by the user's group. User: $user. HomeDir: $homedir. User Group: $usergroup. HomeDir Group: $filegroup."; done`
        pattern ``
    OBJECT_END
CTN_END
CRI_END
DEF_END