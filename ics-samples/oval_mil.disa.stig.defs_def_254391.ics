DEF
VAR var_25439102 string ``
VAR var_25439101 string ``
VAR var_25439100 string ``
RUN var_25439102 EXTRACT
    OBJ obj_25439111 value
RUN_END
RUN var_25439100 EXTRACT
    OBJ obj_25439100 value
RUN_END
STATE ste_25439100
    trustee_sid string equals `S-1-5-32-544`
STATE_END
STATE ste_25439102
    standard_delete boolean equals `true`
    standard_read_control boolean equals `true`
    standard_write_dac boolean equals `true`
    standard_write_owner boolean equals `true`
    standard_synchronize boolean equals `true`
    generic_read boolean equals `true`
    generic_write boolean equals `true`
    generic_execute boolean equals `true`
    file_read_data boolean equals `true`
    file_write_data boolean equals `true`
    file_append_data boolean equals `true`
    file_read_ea boolean equals `true`
    file_write_ea boolean equals `true`
    file_execute boolean equals `true`
    file_delete_child boolean equals `true`
    file_read_attributes boolean equals `true`
    file_write_attributes boolean equals `true`
STATE_END
STATE ste_25439101
    trustee_sid string equals `S-1-5-18`
STATE_END
STATE ste_25439103
    standard_delete boolean equals `false`
    standard_read_control boolean equals `false`
    standard_write_dac boolean equals `false`
    standard_write_owner boolean equals `false`
    standard_synchronize boolean equals `false`
    generic_read boolean equals `false`
    generic_write boolean equals `false`
    generic_execute boolean equals `false`
    file_read_data boolean equals `false`
    file_write_data boolean equals `false`
    file_append_data boolean equals `false`
    file_read_ea boolean equals `false`
    file_write_ea boolean equals `false`
    file_execute boolean equals `false`
    file_delete_child boolean equals `false`
    file_read_attributes boolean equals `false`
    file_write_attributes boolean equals `false`
STATE_END
CRI AND
CTN fileeffectiverights53
    TEST `at least one exists` all
    STATE_REF ste_25439102
    OBJECT obj_25439102
        path VAR var_25439100
        filename `^(.*)$`
        trustee_sid `S-1-5-18`
    OBJECT_END
CTN_END
CTN fileeffectiverights53
    TEST `at least one exists` all
    STATE_REF ste_25439102
    OBJECT obj_25439103
        path VAR var_25439100
        filename `^(.*)$`
        trustee_sid `S-1-5-32-544`
    OBJECT_END
CTN_END
CTN fileeffectiverights53
    TEST `none exist` all
    OBJECT obj_25439104
        path VAR var_25439100
        filename `^(.*)$`
        trustee_sid `.*`
        FILTER include
            STATE_REF ste_25439100
        FILTER_END
        FILTER include
            STATE_REF ste_25439101
        FILTER_END
        FILTER include
            STATE_REF ste_25439103
        FILTER_END
    OBJECT_END
CTN_END
CTN fileeffectiverights53
    TEST `at least one exists` all
    STATE_REF ste_25439102
    OBJECT obj_25439105
        path VAR var_25439101
        filename `^(.*)$`
        trustee_sid `S-1-5-18`
    OBJECT_END
CTN_END
CTN fileeffectiverights53
    TEST `at least one exists` all
    STATE_REF ste_25439102
    OBJECT obj_25439106
        path VAR var_25439101
        filename `^(.*)$`
        trustee_sid `S-1-5-32-544`
    OBJECT_END
CTN_END
CTN fileeffectiverights53
    TEST `none exist` all
    OBJECT obj_25439107
        path VAR var_25439101
        filename `^(.*)$`
        trustee_sid `.*`
        FILTER include
            STATE_REF ste_25439100
        FILTER_END
        FILTER include
            STATE_REF ste_25439101
        FILTER_END
        FILTER include
            STATE_REF ste_25439103
        FILTER_END
    OBJECT_END
CTN_END
CTN fileeffectiverights53
    TEST `at least one exists` all
    STATE_REF ste_25439102
    OBJECT obj_25439108
        path VAR var_25439102
        filename `^(.*)$`
        trustee_sid `S-1-5-18`
    OBJECT_END
CTN_END
CTN fileeffectiverights53
    TEST `at least one exists` all
    STATE_REF ste_25439102
    OBJECT obj_25439109
        path VAR var_25439102
        filename `^(.*)$`
        trustee_sid `S-1-5-32-544`
    OBJECT_END
CTN_END
CTN fileeffectiverights53
    TEST `none exist` all
    OBJECT obj_25439110
        path VAR var_25439102
        filename `^(.*)$`
        trustee_sid `.*`
        FILTER include
            STATE_REF ste_25439100
        FILTER_END
        FILTER include
            STATE_REF ste_25439101
        FILTER_END
        FILTER include
            STATE_REF ste_25439103
        FILTER_END
    OBJECT_END
CTN_END
CTN registry
    TEST `any exist` all
    OBJECT obj_25439111
        hive `HKEY_LOCAL_MACHINE`
        key `System\CurrentControlSet\Services\NTDS\Parameters`
        name `DSA Working Directory`
    OBJECT_END
CTN_END
CRI_END
DEF_END