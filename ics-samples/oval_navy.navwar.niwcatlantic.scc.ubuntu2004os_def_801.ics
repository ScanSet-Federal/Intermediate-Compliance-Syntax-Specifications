DEF
VAR var_802 string ``
VAR var_801 string ``
RUN var_802 EXTRACT
    OBJ obj_813 inet_addr
RUN_END
RUN var_801 EXTRACT
    OBJ obj_803 inet_addr
RUN_END
CRI AND
CTN shellcommand
    TEST `at least one exists` all
    STATE ste_801
        subexpression string equals `
				Plugins\s+for\s+the\s+audit\s+event\s+dispatcher\s+audispd\-plugins`
    STATE_END
    OBJECT obj_801
        shell `bash`
        command `dpkg -l | grep audispd-plugins`
        pattern `
				\s*ii\s+(Plugins\s+for\s+the\s+audit\s+event\s+dispatcher\s+audispd\-plugins)\s+`
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` all
    OBJECT obj_802
        filepath `/etc/audit/plugins.d/au-remote.conf`
        pattern `^\s*active\s*=\s*yes\s*`
        instance `1`
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` `at least one`
    STATE ste_805
        instance int `greater than or equal` `1`
        subexpression string equals `
				^((((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])))|((?:(?!0{1,4}:)(?:(?:[0-9a-fA-F]){1,4}):)(?:(?:(?:(?:[0-9a-fA-F]){1,4}):)|:){4}(?:[0-9a-fA-F]){1,4}))$`
    STATE_END
    OBJECT obj_804
        path `/etc/audit`
        filename `audisp-remote.conf`
        pattern `\s*remote_server\s*=\s*(\S+)(?:\s|$)`
        instance `1`
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `at least one exists` `at least one` OR
    STATE ste_806
        instance int `greater than or equal` `1`
        subexpression string equals `VAR var_801`
    STATE_END
    STATE ste_807
        instance int `greater than or equal` `1`
        subexpression string equals `VAR var_802`
    STATE_END
    OBJECT obj_804
        path `/etc/audit`
        filename `audisp-remote.conf`
        pattern `\s*remote_server\s*=\s*(\S+)(?:\s|$)`
        instance `1`
    OBJECT_END
CTN_END
CTN interface
    TEST `any exist` all
    OBJECT obj_813
        name `.*`
        FILTER include
            STATE_REF ste_804
        FILTER_END
    OBJECT_END
CTN_END
CTN interface
    TEST `any exist` all
    OBJECT obj_803
        name `.*`
        FILTER include
            STATE_REF ste_803
        FILTER_END
    OBJECT_END
CTN_END
CRI_END
DEF_END