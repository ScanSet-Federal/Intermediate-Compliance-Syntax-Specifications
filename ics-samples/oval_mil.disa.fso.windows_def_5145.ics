DEF
STATE ste_463300
    security_principle string equals `Administrators`
STATE_END
STATE ste_463700
    seremoteinteractivelogonright boolean equals `0`
STATE_END
STATE ste_514500
    security_principle string equals `Remote Desktop Users`
STATE_END
SET obj_514500 union
    OBJECT obj_461700
        security_principle `.*`
    OBJECT_END
    FILTER include
        STATE_REF oval:mil.disa.fso.windows:ste:463300
    FILTER_END
    FILTER include
        STATE_REF oval:mil.disa.fso.windows:ste:514500
    FILTER_END
SET_END
SET obj_463300 union
    OBJECT obj_461700
        security_principle `.*`
    OBJECT_END
    FILTER include
        STATE_REF oval:mil.disa.fso.windows:ste:463300
    FILTER_END
SET_END
CRI OR
CRI AND
CTN wmi57
    TEST `at least one exists` all
    STATE ste_514501
        result record equals `
    `
    STATE_END
    OBJECT obj_514501
        namespace `root\cimv2`
        wql `SELECT id FROM Win32_ServerFeature WHERE name='Remote Desktop Services'`
    OBJECT_END
CTN_END
CTN accesstoken
    TEST `any exist` all
    STATE_REF ste_463700
    OBJECT obj_463300
        SET_REF obj_463300
    OBJECT_END
CTN_END
CRI_END
CRI AND
CTN wmi57
    TEST `at least one exists` all
    STATE ste_514501
        result record equals `
    `
    STATE_END
    OBJECT obj_514501
        namespace `root\cimv2`
        wql `SELECT id FROM Win32_ServerFeature WHERE name='Remote Desktop Services'`
    OBJECT_END
CTN_END
CTN accesstoken
    TEST `any exist` all
    STATE_REF ste_463700
    OBJECT obj_514500
        SET_REF obj_514500
    OBJECT_END
CTN_END
CRI_END
CRI_END
DEF_END