DEF
VAR var_3101 string ``
VAR var_3102 string ``
RUN var_3101 CONCAT
    literal `^\s*-w\s+`
    OBJ obj_3102 subexpression
    literal `\s+-p\s+wa\s+-k\s+logins$`
RUN_END
RUN var_3102 CONCAT
    literal `^\s*-w\s+`
    OBJ obj_3105 subexpression
    literal `\s+-p\s+wa\s+-k\s+logins$`
RUN_END
STATE ste_3101
    text string equals `^\s*-w\s+/var/log/faillock\s+-p\s+wa\s+-k\s+logins`
STATE_END
CRI OR
CRI AND
CTN textfilecontent54
    TEST `at least one exists` all
    STATE_REF ste_3101
    OBJECT obj_3101
        filepath `/etc/audit/audit.rules`
        pattern VAR var_3101
        instance `1`
        behavior singleline false
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `only one exists` all
    STATE ste_3102
        subexpression string equals `^8\.[01](\.\d+)*`
    STATE_END
    OBJECT obj_3103
        filepath `/etc/os-release`
        pattern `^\s*VERSION_ID="([\d.]+)"`
        instance `1`
    OBJECT_END
CTN_END
CRI_END
CRI AND
CTN textfilecontent54
    TEST `at least one exists` all
    STATE_REF ste_3101
    OBJECT obj_3104
        filepath `/etc/audit/audit.rules`
        pattern VAR var_3102
        instance `1`
        behavior singleline false
    OBJECT_END
CTN_END
CTN textfilecontent54
    TEST `only one exists` all
    STATE ste_3103
        subexpression string equals `^8\.([2-9]|1\d)`
    STATE_END
    OBJECT obj_3103
        filepath `/etc/os-release`
        pattern `^\s*VERSION_ID="([\d.]+)"`
        instance `1`
    OBJECT_END
CTN_END
CRI_END
CTN textfilecontent54
    TEST `any exist` all
    OBJECT obj_3105
        filepath `/etc/security/faillock.conf`
        pattern `^\s*dir\s*=\s*(\S+)\b`
        instance `1`
        behavior singleline false
    OBJECT_END
CTN_END
CRI_END
DEF_END