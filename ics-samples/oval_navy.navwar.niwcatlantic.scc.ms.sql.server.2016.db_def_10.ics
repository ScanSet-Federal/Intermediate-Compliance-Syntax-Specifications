DEF
VAR var_2 string `2016|2017|2019|2022`
VAR var_10 string ``
VAR var_1 string `sqlserver`
CRI OR
CTN sqlext
    TEST `any exist` all
    STATE ste_4
        result string equals `
    `
    STATE_END
    OBJECT obj_4
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database `.*`
        sql `select containment,name from sys.databases WHERE name = DB_NAME()`
        behavior context database
    OBJECT_END
CTN_END
CRI OR
CRI OR
CTN sqlext
    TEST `any exist` all
    STATE ste_1
        result string equals `
    `
    STATE_END
    OBJECT obj_1
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `EXEC sp_configure 'contained database authentication'`
        behavior context instance
    OBJECT_END
CTN_END
CTN sqlext
    TEST `any exist` all
    STATE ste_2
        result string equals `
    `
    STATE_END
    OBJECT obj_1
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `EXEC sp_configure 'contained database authentication'`
        behavior context instance
    OBJECT_END
CTN_END
CRI_END
CRI OR
CTN sqlext
    TEST `any exist` all
    STATE ste_3
        result string equals `
    `
    STATE_END
    OBJECT obj_3
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `SELECT CASE SERVERPROPERTY('IsIntegratedSecurityOnly')   
 WHEN 1 THEN 'Windows Authentication'   
 WHEN 0 THEN 'Windows and SQL Server Authentication'   
END as [mode]`
        behavior context instance
    OBJECT_END
CTN_END
CTN sqlext
    TEST `any exist` all
    STATE ste_5
        result string equals `
    `
    STATE_END
    OBJECT obj_5
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `SELECT name as user_name
FROM sys.database_principals
WHERE type_desc = 'SQL_USER'
AND authentication_type_desc = 'DATABASE';`
        behavior context instance
    OBJECT_END
CTN_END
CRI_END
CRI_END
CRI_END
DEF_END