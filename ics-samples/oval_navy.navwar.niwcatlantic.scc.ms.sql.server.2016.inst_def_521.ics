DEF
VAR var_521 string ``
VAR var_1 string `sqlserver`
VAR var_2 string `2016|2017|2019|2022`
CRI AND
CTN sqlext
    TEST `any exist` all
    STATE ste_521
        result string equals `
    `
    STATE_END
    OBJECT obj_521
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `SELECT 
  name as linked_server,
  provider,
  data_source
FROM sys.servers
WHERE is_linked = 1;`
        behavior context instance
    OBJECT_END
CTN_END
CTN sqlext
    TEST `none exist` all
    OBJECT obj_522
        engine VAR var_1
        version VAR var_2
        instance `.*`
        database ``
        sql `SELECT s.name as linked_server, p.principal_id, USER_NAME(p.principal_id) as user_name, l.remote_name as remote_user_name 
FROM sys.servers s 
JOIN sys.linked_logins l ON s.server_id = l.server_id 
LEFT JOIN sys.server_principals p ON l.local_principal_id = p.principal_id 
WHERE s.is_linked = 1 AND l.remote_name != NULL`
        behavior context instance
    OBJECT_END
CTN_END
CRI_END
DEF_END